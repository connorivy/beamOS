<?xml version="1.0" encoding="utf-8"?>
<Project>
  <Import Project="$([MSBuild]::GetPathOfFileAbove('Directory.Build.props', '$(MSBuildThisFileDirectory)..\'))" />
  <Import Project="BeamOs.Sdk.user.props" Condition="Exists('BeamOs.Sdk.user.props')" />

  <!-- In development, regenerate wrappers after build instead of after publish -->
  <PropertyGroup Condition="'$(ContinuousIntegrationEnv)' == 'false' and '$(DotWrapRelativeLocation)' != ''">
    <DotWrapGenerateAfterBuild>true</DotWrapGenerateAfterBuild>
  </PropertyGroup>
  <!-- Use project references locally, but use nuget package in CI -->
  <ItemGroup Condition="'$(ContinuousIntegrationEnv)' == 'false' and '$(DotWrapRelativeLocation)' != ''">
    <ProjectReference
      Include="$(DotWrapRelativeLocation)\src\DotWrap.Generator\DotWrap.Generator.csproj"
      OutputItemType="Analyzer"
      ReferenceOutputAssembly="false"
    />
    <ProjectReference Include="$(DotWrapRelativeLocation)\src\DotWrap\DotWrap.csproj" />
    <ProjectReference Include="$(DotWrapRelativeLocation)\src\DotWrap.MSBuild\DotWrap.MSBuild.csproj" />
  </ItemGroup>
  <Import
    Condition="'$(ContinuousIntegrationEnv)' == 'false' and '$(DotWrapRelativeLocation)' != ''"
    Project="$(DotWrapRelativeLocation)\src\DotWrap\Build\DotWrap.targets"
  />
  <Import
    Condition="'$(ContinuousIntegrationEnv)' == 'false' and '$(DotWrapRelativeLocation)' != ''"
    Project="$(DotWrapRelativeLocation)\src\DotWrap\Build\DotWrap.props"
  />
  <ItemGroup Condition="'$(ContinuousIntegrationEnv)' != 'false' or '$(DotWrapRelativeLocation)' == ''">
    <PackageReference Include="DotWrap" />
  </ItemGroup>
</Project>
